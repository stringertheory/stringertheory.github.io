function setSeed(){var e=Qs.parse(window.location.hash)["#seed"];e?Math.seedrandom(e):Math.seedrandom()}function makeSVG(e,n,t=0){setSeed();var r=Snap("#canvas");return r.clear(),r.attr({width:"100%",viewBox:Snap.format("{min_x} {min_y} {width} {height}",{min_x:-t,min_y:-t,width:e+2*t,height:n+2*t})}),r.group()}function dataURItoBlob(e){for(var n=atob(e.split(",")[1]),t=e.split(",")[0].split(":")[1].split(";")[0],r=new ArrayBuffer(n.length),a=new Uint8Array(r),o=0;o<n.length;o++)a[o]=n.charCodeAt(o);return new Blob([r],{type:t})}function download_svg(e){e.toDataURL("image/png",{callback:function(n){var t=n.replace("image/png","image/octet-stream"),r=md5(t).substring(0,6),a=window.location.pathname+window.location.hash+"-"+r,o=a+".png",i=a+".svg",u=dataURItoBlob(t);download_as_file(o,URL.createObjectURL(u));var c=(new XMLSerializer).serializeToString(e),d="data:text/plain;charset=utf-8,";download_as_file(i,d+=encodeURIComponent(c))}})}function download(e="#canvas"){"#"===e[0]&&(e=e.split("#")[1]);var n=document.getElementById(e);"svg"==n.nodeName?download_svg(n):"CANVAS"==n.nodeName?download_canvas(n):console.error("unknown element",n.nodeName)}function download_canvas(e){var n=md5(e).substring(0,6);download_as_file(window.location.pathname+window.location.hash+"-"+n+".png",e.toDataURL())}function download_as_file(e,n){var t=document.createElement("a");t.href=n,t.download=e,t.click(),t.remove()}function jitter(e){return e*(Math.random()-.5)}function convertToPath(e){var n="";return _.each(e,function(t,r){var a=t[0],o=t[1];0===r?n+="M"+a+","+o+" R":r===e.length-1?n+=a+","+o:n+=a+","+o+","}),n}function makeid(e){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";n+="abcdefghijklmnopqrstuvwxyz";for(var t=(n+="0123456789").length,r="",a=0;a<e;a++)r+=n.charAt(Math.floor(Math.random()*t));var o={seed:r};return"undefined"!=typeof parameters&&_.each(_.keys(parameters),function(e){o[e]=parameters[e].slider.get()}),Qs.stringify(o)}function compliment(e,n,t){void 0===n&&(n=180),void 0===t&&(t=1);var r=e.hcl()[0]+n,a=e.hcl()[1],o=e.hcl()[2]*t;return chroma.hcl(r,a,o)}function make_parameters(e,n){var t=document.getElementById(e),r={},a=Qs.parse(window.location.hash);return _.each(n,function(e){var n=e.name;n in a&&(e.start=[a[n]]);var o=document.createElement("div");o.classList.add("parameter");var i=document.createElement("div");i.id="slider-"+n,i.classList.add("parameter-slider"),i.setAttribute("data-name",n.replace(/_/g," ")),o.appendChild(i);var u=document.createElement("input");u.id="slider-"+n+"-value",u.classList.add("parameter-input"),o.appendChild(u),t.appendChild(o),noUiSlider.create(i,e),i.noUiSlider.on("update",function(e,n){u.value=e[n]}),u.addEventListener("change",function(){i.noUiSlider.set(this.value)});var c=e.metric_name||e.name;r[n]={slider:i.noUiSlider,metric_name:c}}),r}function format_int(){return{to:function(e){return parseInt(e)},from:function(e){return parseInt(e)}}}function format_decimal(){return{to:function(e){return new Number(e).toFixed(3)},from:function(e){return new Number(e).toFixed(3)}}}!function(){function e(e){var n=[],t=Math.pow(e+16,3)/1560896;t=t>R?t:e/I;for(var r=0;3>r;){var a=r++,o=S[a][0],i=S[a][1];a=S[a][2];for(var u=0;2>u;){var c=u++,d=(632260*a-126452*i)*t+126452*c;n.push({b:(284517*o-94839*a)*t/d,a:((838422*a+769860*i+731718*o)*e*t-769860*c*e)/d})}}return n}function n(n){n=e(n);for(var t=1/0,r=0;r<n.length;){var a=n[r];++r,t=Math.min(t,Math.abs(a.a)/Math.sqrt(Math.pow(a.b,2)+1))}return t}function t(n,t){t=t/360*Math.PI*2,n=e(n);for(var r=1/0,a=0;a<n.length;){var o=n[a];++a,0<=(o=o.a/(Math.sin(t)-o.b*Math.cos(t)))&&(r=Math.min(r,o))}return r}function r(e,n){for(var t=0,r=0,a=e.length;r<a;){var o=r++;t+=e[o]*n[o]}return t}function a(e){return.0031308>=e?12.92*e:1.055*Math.pow(e,.4166666666666667)-.055}function o(e){return.04045<e?Math.pow((e+.055)/1.055,2.4):e/12.92}function i(e){return[a(r(S[0],e)),a(r(S[1],e)),a(r(S[2],e))]}function u(e){return e=[o(e[0]),o(e[1]),o(e[2])],[r(L[0],e),r(L[1],e),r(L[2],e)]}function c(e){var n=e[0],t=e[1];return 0!=(e=n+15*t+3*e[2])?(n=4*n/e,e=9*t/e):e=n=NaN,0==(t=t<=R?t/_*I:116*Math.pow(t/_,.3333333333333333)-16)?[0,0,0]:[t,13*t*(n-k),13*t*(e-N)]}function d(e){var n=e[0];if(0==n)return[0,0,0];var t=e[1]/(13*n)+k;return e=e[2]/(13*n)+N,[t=0-9*(n=8>=n?_*n/I:_*Math.pow((n+16)/116,3))*t/((t-4)*e-t*e),n,(9*n-15*e*n-e*t)/(3*e)]}function l(e){var n=e[0],t=e[1],r=e[2];return 1e-8>(e=Math.sqrt(t*t+r*r))?t=0:0>(t=180*Math.atan2(r,t)/Math.PI)&&(t=360+t),[n,e,t]}function s(e){var n=e[1],t=e[2]/360*2*Math.PI;return[e[0],Math.cos(t)*n,Math.sin(t)*n]}function h(e){var n=e[0],r=e[1];return 99.9999999<(e=e[2])?[100,0,n]:1e-8>e?[0,0,n]:[e,r=t(e,n)/100*r,n]}function f(e){var n=e[0],r=e[1];return e=e[2],99.9999999<n?[e,0,100]:1e-8>n?[e,0,0]:[e,r/t(n,e)*100,n]}function v(e){var t=e[0],r=e[1];return 99.9999999<(e=e[2])?[100,0,t]:1e-8>e?[0,0,t]:[e,r=n(e)/100*r,t]}function g(e){var t=e[0],r=e[1];return e=e[2],99.9999999<t?[e,0,100]:1e-8>t?[e,0,0]:[e,r/n(t)*100,t]}function p(e){for(var n="#",t=0;3>t;){var r=t++,a=(r=Math.round(255*e[r]))%16;n+=U.charAt((r-a)/16|0)+U.charAt(a)}return n}function m(e){e=e.toLowerCase();for(var n=[],t=0;3>t;){var r=t++;n.push((16*U.indexOf(e.charAt(2*r+1))+U.indexOf(e.charAt(2*r+2)))/255)}return n}function w(e){return i(d(s(e)))}function M(e){return l(c(u(e)))}function b(e){return w(h(e))}function x(e){return f(M(e))}function T(e){return w(v(e))}function y(e){return g(M(e))}var S=[[3.240969941904521,-1.537383177570093,-.498610760293],[-.96924363628087,1.87596750150772,.041555057407175],[.055630079696993,-.20397695888897,1.056971514242878]],L=[[.41239079926595,.35758433938387,.18048078840183],[.21263900587151,.71516867876775,.072192315360733],[.019330818715591,.11919477979462,.95053215224966]],_=1,k=.19783000664283,N=.46831999493879,I=903.2962962,R=.0088564516,U="0123456789abcdef";window.hsluv={hsluvToRgb:b,rgbToHsluv:x,hpluvToRgb:T,rgbToHpluv:y,hsluvToHex:function(e){return p(b(e))},hexToHsluv:function(e){return x(m(e))},hpluvToHex:function(e){return p(T(e))},hexToHpluv:function(e){return y(m(e))},lchToHpluv:g,hpluvToLch:v,lchToHsluv:f,hsluvToLch:h,lchToLuv:s,luvToLch:l,xyzToLuv:c,luvToXyz:d,xyzToRgb:i,rgbToXyz:u,lchToRgb:w,rgbToLch:M}}(),SVGElement.prototype.toDataURL=function(e,n){var t,r=this,a=1200;function o(e){console.log("SVG.toDataURL:",e)}function i(e){return window.XMLSerializer?(o("using standard XMLSerializer.serializeToString"),(new XMLSerializer).serializeToString(e)):(o("using custom XMLSerializerForIE"),function e(n){var t="";t+="<"+n.nodeName;for(var r=0;r<n.attributes.length;r++)t+=" "+n.attributes[r].name+"='"+n.attributes[r].value+"'";if(n.hasChildNodes()){for(t+=">\n",r=0;r<n.childNodes.length;r++)t+=e(n.childNodes[r]);t+="</"+n.nodeName+">\n"}else t+=" />\n";return t}(e))}function u(e){var n="data:image/svg+xml;base64,";return window.btoa?(o("using window.btoa for base64 encoding"),n+=btoa(e)):(o("using custom base64 encoder"),n+=Base64.encode(e)),n}switch(e||(e="image/svg+xml"),n||(n={}),n.keepNonSafe&&o("NOTE: keepNonSafe is NOT supported and will be ignored!"),n.keepOutsideViewport&&o("NOTE: keepOutsideViewport is only supported with canvg exporter."),e){case"image/svg+xml":return t=u(i(r)),o(e+" length: "+t.length),n.callback&&n.callback(t),t;case"image/png":case"image/jpeg":switch(n.renderer||(window.canvg?n.renderer="canvg":n.renderer="native"),n.renderer){case"canvg":return o("using canvg renderer for png export"),function(e){var t=document.createElement("canvas"),a=(t.getContext("2d"),i(r)),u=n.keepOutsideViewport;if(u)var c=r.getBBox();return canvg(t,a,{ignoreMouse:!0,ignoreAnimation:!0,offsetX:u?-c.x:void 0,offsetY:u?-c.y:void 0,scaleWidth:u?c.width+c.x:void 0,scaleHeight:u?c.height+c.y:void 0,renderCallback:function(){o("exported image dimensions "+[t.width,t.height]);var r=t.toDataURL(e);o(e+" length: "+r.length),n.callback&&n.callback(r)}}),t.toDataURL(e)}(e);case"native":return o("using native renderer for png export. THIS MIGHT FAIL."),function(e){var t=document.createElement("canvas"),c=t.getContext("2d"),d=new Image,l=i(r);d.src=u(l),d.onload=function(){o("exported image size: "+[d.width,d.height]),t.width=a,t.height=a*(d.height/d.width),c.drawImage(d,0,0);var r=t.toDataURL(e);o(e+" length: "+r.length),n.callback?n.callback(r):o("WARNING: no callback set, so nothing happens.")},d.onerror=function(){console.log("Can't export! Maybe your browser doesn't support SVG in img element or SVG input for Canvas drawImage?\nhttp://en.wikipedia.org/wiki/SVG#Native_support")}}(e);default:o("unknown png renderer given, doing noting ("+n.renderer+")")}break;default:o("Sorry! Exporting as '"+e+"' is not supported!")}},function(e){var n=e.noise={};function t(e,n,t){this.x=e,this.y=n,this.z=t}t.prototype.dot2=function(e,n){return this.x*e+this.y*n},t.prototype.dot3=function(e,n,t){return this.x*e+this.y*n+this.z*t};var r=[new t(1,1,0),new t(-1,1,0),new t(1,-1,0),new t(-1,-1,0),new t(1,0,1),new t(-1,0,1),new t(1,0,-1),new t(-1,0,-1),new t(0,1,1),new t(0,-1,1),new t(0,1,-1),new t(0,-1,-1)],a=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],o=new Array(512),i=new Array(512);n.seed=function(e){e>0&&e<1&&(e*=65536),(e=Math.floor(e))<256&&(e|=e<<8);for(var n=0;n<256;n++){var t;t=1&n?a[n]^255&e:a[n]^e>>8&255,o[n]=o[n+256]=t,i[n]=i[n+256]=r[t%12]}},n.seed(0);var u=.5*(Math.sqrt(3)-1),c=(3-Math.sqrt(3))/6,d=1/6;function l(e){return e*e*e*(e*(6*e-15)+10)}function s(e,n,t){return(1-t)*e+t*n}n.simplex2=function(e,n){var t,r,a=(e+n)*u,d=Math.floor(e+a),l=Math.floor(n+a),s=(d+l)*c,h=e-d+s,f=n-l+s;h>f?(t=1,r=0):(t=0,r=1);var v=h-t+c,g=f-r+c,p=h-1+2*c,m=f-1+2*c,w=i[(d&=255)+o[l&=255]],M=i[d+t+o[l+r]],b=i[d+1+o[l+1]],x=.5-h*h-f*f,T=.5-v*v-g*g,y=.5-p*p-m*m;return 70*((x<0?0:(x*=x)*x*w.dot2(h,f))+(T<0?0:(T*=T)*T*M.dot2(v,g))+(y<0?0:(y*=y)*y*b.dot2(p,m)))},n.simplex3=function(e,n,t){var r,a,u,c,l,s,h=(e+n+t)*(1/3),f=Math.floor(e+h),v=Math.floor(n+h),g=Math.floor(t+h),p=(f+v+g)*d,m=e-f+p,w=n-v+p,M=t-g+p;m>=w?w>=M?(r=1,a=0,u=0,c=1,l=1,s=0):m>=M?(r=1,a=0,u=0,c=1,l=0,s=1):(r=0,a=0,u=1,c=1,l=0,s=1):w<M?(r=0,a=0,u=1,c=0,l=1,s=1):m<M?(r=0,a=1,u=0,c=0,l=1,s=1):(r=0,a=1,u=0,c=1,l=1,s=0);var b=m-r+d,x=w-a+d,T=M-u+d,y=m-c+2*d,S=w-l+2*d,L=M-s+2*d,_=m-1+.5,k=w-1+.5,N=M-1+.5,I=i[(f&=255)+o[(v&=255)+o[g&=255]]],R=i[f+r+o[v+a+o[g+u]]],U=i[f+c+o[v+l+o[g+s]]],A=i[f+1+o[v+1+o[g+1]]],z=.6-m*m-w*w-M*M,E=.6-b*b-x*x-T*T,C=.6-y*y-S*S-L*L,H=.6-_*_-k*k-N*N;return 32*((z<0?0:(z*=z)*z*I.dot3(m,w,M))+(E<0?0:(E*=E)*E*R.dot3(b,x,T))+(C<0?0:(C*=C)*C*U.dot3(y,S,L))+(H<0?0:(H*=H)*H*A.dot3(_,k,N)))},n.perlin2=function(e,n){var t=Math.floor(e),r=Math.floor(n);e-=t,n-=r;var a=i[(t&=255)+o[r&=255]].dot2(e,n),u=i[t+o[r+1]].dot2(e,n-1),c=i[t+1+o[r]].dot2(e-1,n),d=i[t+1+o[r+1]].dot2(e-1,n-1),h=l(e);return s(s(a,c,h),s(u,d,h),l(n))},n.perlin3=function(e,n,t){var r=Math.floor(e),a=Math.floor(n),u=Math.floor(t);e-=r,n-=a,t-=u;var c=i[(r&=255)+o[(a&=255)+o[u&=255]]].dot3(e,n,t),d=i[r+o[a+o[u+1]]].dot3(e,n,t-1),h=i[r+o[a+1+o[u]]].dot3(e,n-1,t),f=i[r+o[a+1+o[u+1]]].dot3(e,n-1,t-1),v=i[r+1+o[a+o[u]]].dot3(e-1,n,t),g=i[r+1+o[a+o[u+1]]].dot3(e-1,n,t-1),p=i[r+1+o[a+1+o[u]]].dot3(e-1,n-1,t),m=i[r+1+o[a+1+o[u+1]]].dot3(e-1,n-1,t-1),w=l(e),M=l(n),b=l(t);return s(s(s(c,v,w),s(d,g,w),b),s(s(h,p,w),s(f,m,w),b),M)}}(this);